
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Cpp Tips Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../book_reading/" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../implementation_scheme/">
            
                <a href="../implementation_scheme/">
            
                    
                    Implementation Scheme
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../implementation_scheme/mixed_precision_training_implementation_scheme.html">
            
                <a href="../implementation_scheme/mixed_precision_training_implementation_scheme.html">
            
                    
                    mixed-precision training implementation scheme
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../tools/">
            
                <a href="../tools/">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../tools/git/">
            
                <a href="../tools/git/">
            
                    
                    Git
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.1" data-path="../tools/git/gitbook_on_github-page.html">
            
                <a href="../tools/git/gitbook_on_github-page.html">
            
                    
                    Gitbook On Github-page
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../paper_reading/">
            
                <a href="../paper_reading/">
            
                    
                    Paper Reading
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../paper_reading/model_compression/">
            
                <a href="../paper_reading/model_compression/">
            
                    
                    Model Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1.1" data-path="../paper_reading/model_compression/quantization_summary.html">
            
                <a href="../paper_reading/model_compression/quantization_summary.html">
            
                    
                    Quantization Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.1.2" data-path="../paper_reading/model_compression/quantization/">
            
                <a href="../paper_reading/model_compression/quantization/">
            
                    
                    Quantization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1.2.1" data-path="../paper_reading/model_compression/quantization/mixed_precision_training.html">
            
                <a href="../paper_reading/model_compression/quantization/mixed_precision_training.html">
            
                    
                    Mixed Precision Training
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../code_reading/">
            
                <a href="../code_reading/">
            
                    
                    Code Reading
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../code_reading/tensorflow/">
            
                <a href="../code_reading/tensorflow/">
            
                    
                    TensorFlow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1.1" data-path="../code_reading/tensorflow/device_support.md">
            
                <span>
            
                    
                    Device Support
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../confusing_tips/confusing_tips.html">
            
                <a href="../confusing_tips/confusing_tips.html">
            
                    
                    Confusing Tips
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="./">
            
                <a href="./">
            
                    
                    Programming Language
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="6.1.1" data-path="cpp_tips.html">
            
                <a href="cpp_tips.html">
            
                    
                    Cpp Tips
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../book_reading/">
            
                <a href="../book_reading/">
            
                    
                    Book Reading
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.2.1" data-path="../book_reading/reinforcement_learning.html">
            
                <a href="../book_reading/reinforcement_learning.html">
            
                    
                    Reinforcement Learning: An Introduction 2ed
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2.2" data-path="../book_reading/csapp.html">
            
                <a href="../book_reading/csapp.html">
            
                    
                    CSAPP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Cpp Tips</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="cpp-tips">Cpp Tips</h1>
<h1 id="1-dynamic-memory-allocation&#x52A8;&#x6001;&#x5185;&#x5B58;&#x5206;&#x914D;">1. Dynamic Memory Allocation(&#x52A8;&#x6001;&#x5185;&#x5B58;&#x5206;&#x914D;)</h1>
<h2 id="11-not-free-allocated-memory-case">1.1. Not Free Allocated Memory Case</h2>
<ul>
<li>Not delete after allocate by <code>new</code>.</li>
<li>Raise error before running <code>delete</code>.</li>
</ul>
<p>for instance:</p>
<pre><code class="lang-cpp">ObjectType* temp_ptr = <span class="hljs-keyword">new</span> ObjectType();
temp_ptr-&gt;foo();
<span class="hljs-keyword">delete</span> temp_ptr;
</code></pre>
<p>If not calling <code>delete</code> or raising error at <code>temp_ptr-&gt;foo();</code>, 
the memory allocated by <code>new</code> will not free, which will cause 
certain block in memory space call not be allocate by other codes.</p>
<h1 id="2-smart-pointer&#x667A;&#x80FD;&#x6307;&#x9488;">2. Smart Pointer(&#x667A;&#x80FD;&#x6307;&#x9488;)</h1>
<h1 id="3-class-function-variable">3. Class, Function, Variable</h1>
<h2 id="31-crossing-field">3.1. Crossing Field</h2>
<h3 id="311-notions-and-syntax-details">3.1.1. Notions and Syntax Details</h3>
<ul>
<li><strong>Static Variable and <code>static</code></strong> </li>
<li><p><strong><code>const</code></strong><br>Refer to <a href="https://www.cnblogs.com/Forever-Kenlen-Ja/p/3776991.html" target="_blank">https://www.cnblogs.com/Forever-Kenlen-Ja/p/3776991.html</a>.</p>
<ul>
<li>using <code>const</code> decorate function/method&apos;s arguments.<br>Sometimes this is not necessray, since in certain cases, the 
functions will build arguments&apos; copy in function body. But in 
some other cases, such as the arguments include pointer, the 
<code>const</code> before these pointer arguments can protect the value 
pointed by these pointer modified by function. 
For some self-defined type arguments, copying these arguments 
in function body is low efficiency, so we can use pointer of 
these variables with a <code>const</code> decoration for protection.<br>For instance:<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">StringCopy</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* strDestination, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *strSource)</span></span>;
</code></pre>
Using <code>const</code> decorate <code>char *strSource</code> can protect the value
pointed by <code>strSource</code> from modified by function.</li>
<li><p>using <code>const</code> decorate function/method&apos;s return(const&#x4FEE;&#x9970;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;)</p>
</li>
<li><p>using <code>const</code> decorate function/method itself(const&#x653E;&#x5728;&#x51FD;&#x6570;&#x4F53;&#x524D;)<br>For instance:</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> <span class="hljs-keyword">const</span> </span>{
  <span class="hljs-keyword">return</span> a + b;
};
<span class="hljs-comment">// It error if use `a = 3;` before `return a + b;`.</span>
</code></pre>
<p>In this case, in function body(&#x51FD;&#x6570;&#x4F53;), we can not modify any 
variables.</p>
</li>
</ul>
</li>
<li><p><strong><code>constexpr</code></strong><br>  Represents &quot;constant expression(&#x5E38;&#x91CF;&#x8868;&#x8FBE;&#x5F0F;)&quot;, which value will 
  never changed and calculated during compiling phase, 
  for instance:</p>
<pre><code class="lang-cpp">  <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">3</span>; <span class="hljs-comment">// Also a constant expression.</span>
  <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; <span class="hljs-comment">// Also a constant expression.</span>

  <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a)</span> </span>{
      <span class="hljs-keyword">return</span> (a + <span class="hljs-number">1</span>);
  }
  <span class="hljs-comment">// This is not constant expression, since the value of </span>
  <span class="hljs-comment">// `m` can only gotten during running phase. </span>
  <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> m = f(<span class="hljs-number">1</span>); 
  <span class="hljs-comment">// So, we can also coding as:</span>
  <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">3</span>;
  <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>;

  <span class="hljs-comment">// we can not write `constexpr int m = f(1)` since `f` </span>
  <span class="hljs-comment">// is not a &quot;constexpr function&quot;.</span>
</code></pre>
<p>  Refer to <a href="https://www.cnblogs.com/td15980891505/p/5137013.html" target="_blank">https://www.cnblogs.com/td15980891505/p/5137013.html</a>.</p>
<ul>
<li><p><strong>constexpr function(&#x7F16;&#x8BD1;&#x671F;&#x51FD;&#x6570;)</strong>
For constexpr function, using <code>constexpr</code> before function 
declaration. Here we have some new notions, such as 
<strong>compiling phase constant</strong>, etc. For instance:</p>
<pre><code class="lang-cpp"><span class="hljs-comment">// `array_size` is a &quot;compiling phase constant&quot;.</span>
<span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">auto</span> array_size = <span class="hljs-number">10</span>;
<span class="hljs-comment">// So the following code could be right compiled, since </span>
<span class="hljs-comment">// the compiler can get the value of `array_size` during </span>
<span class="hljs-comment">// compiling phase.</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span>&lt;<span class="hljs-keyword">int</span>, array_size&gt; data2; 

<span class="hljs-comment">// The following case con not be compiled, since the compiler </span>
<span class="hljs-comment">// con not get the value of value of `array_size` during </span>
<span class="hljs-comment">// compiling phase so can not compile next line.</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> array_size = sz; 
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span>&lt;<span class="hljs-keyword">int</span>, array_size&gt; data;
</code></pre>
<p>Now extending to constexpr function:</p>
<pre><code class="lang-cpp"><span class="hljs-comment">// cpp 11</span>
<span class="hljs-function"><span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">int</span> <span class="hljs-title">factorial</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>{
  <span class="hljs-keyword">return</span> n == <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-function">n * <span class="hljs-title">factorial</span><span class="hljs-params">(n - <span class="hljs-number">1</span>)</span></span>;
}
<span class="hljs-comment">// cpp 14</span>
<span class="hljs-function"><span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">int</span> <span class="hljs-title">factorial2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>{
  <span class="hljs-keyword">int</span> result = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) {
      result *= i;
  }
  <span class="hljs-keyword">return</span> result;
}
</code></pre>
<p>Getting the value of expression is during compiling phase is 
pretty useful. In cpp 11, there are some limitations, such as you 
can not define declare variables in constexpr function body, 
can not using &quot;for loop&quot;,  can only has a <code>return</code> expression 
in function body, stc. This means we always have to use 
&quot;iteration function(&#x9012;&#x5F52;&#x51FD;&#x6570;)&quot; form many times.<br>In cpp 14, many of these limitations has been droped.<br>Refer to <a href="https://blog.csdn.net/zwvista/article/details/54429416" target="_blank">https://blog.csdn.net/zwvista/article/details/54429416</a>.</p>
</li>
</ul>
</li>
</ul>
<h2 id="32-function">3.2. Function</h2>
<h2 id="33-class">3.3. Class</h2>
<h3 id="331-syntax-details">3.3.1. Syntax Details</h3>
<ul>
<li><code>explicit</code><br>Keyword <code>explicit</code> can only used for decorating constructor function 
with only one non-default argument.<br>Refer to <a href="https://blog.csdn.net/qq_37233607/article/details/79051075" target="_blank">https://blog.csdn.net/qq_37233607/article/details/79051075</a>.</li>
</ul>
<h1 id="4-code-reuse&#x4EE3;&#x7801;&#x91CD;&#x7528;">4. Code Reuse(&#x4EE3;&#x7801;&#x91CD;&#x7528;)</h1>
<h2 id="41-macro&#x5B8F;">4.1. Macro(&#x5B8F;)</h2>
<h3 id="411-syntax-details">4.1.1. Syntax Details</h3>
<ul>
<li><strong><code>##</code> and <code>#</code></strong>: <code>##</code> used for linking arguments, <code>#</code> used for 
replacement or, &quot;converting to string&quot;, refer to following example:</li>
</ul>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONVERT(name) #name</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;You and %s are friends.\n&quot;</span>, CONVERT(James));
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
};
<span class="hljs-comment">// This will print &quot;You and James are friends.&quot;.</span>
</code></pre>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CAT(batman, robin) batman ## robin</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, CAT(A, BCD));
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
<span class="hljs-comment">// This will print &quot;ABCD&quot;.</span>
</code></pre>
<ul>
<li><strong><code>##__VA_ARGS__</code> and <code>__VA_ARGS__</code> and <code>...</code></strong>: <code>__VA_ARGS__</code> and 
<code>...</code> are similiar, both means the number of macro function&apos;s 
arguments is variable; <code>##__VA_ARGS__</code> will be helpful to handling 
the case that variable arguments number is zero. Refer to 
<a href="https://blog.csdn.net/guozhongwei1/article/details/82659435" target="_blank">https://blog.csdn.net/guozhongwei1/article/details/82659435</a>.</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Programming Language">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../book_reading/" class="navigation navigation-next " aria-label="Next page: Book Reading">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Cpp Tips","level":"6.1.1","depth":2,"next":{"title":"Book Reading","level":"6.2","depth":1,"path":"book_reading/README.md","ref":"book_reading/README.md","articles":[{"title":"Reinforcement Learning: An Introduction 2ed","level":"6.2.1","depth":2,"path":"book_reading/reinforcement_learning.md","ref":"book_reading/reinforcement_learning.md","articles":[]},{"title":"CSAPP","level":"6.2.2","depth":2,"path":"book_reading/csapp.md","ref":"book_reading/csapp.md","articles":[]}]},"previous":{"title":"Programming Language","level":"6.1","depth":1,"path":"programming_language/README.md","ref":"programming_language/README.md","articles":[{"title":"Cpp Tips","level":"6.1.1","depth":2,"path":"programming_language/cpp_tips.md","ref":"programming_language/cpp_tips.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"programming_language/cpp_tips.md","mtime":"2019-02-19T11:00:48.691Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-02-19T11:05:46.417Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

